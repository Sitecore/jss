<!DOCTYPE html>
<html lang="en" data-reactroot=""><head><link rel="stylesheet" href="/dist/server.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/dist/client.css"/><link rel="icon" type="image/png" href="/assets/img/favicon-32x32.png"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Sitecore JavaScript Services Documentation"/><title data-react-helmet="true">SSR Recommended Practices | Sitecore JSS Documentation</title></head><body><div id="app"><section class="ant-layout" id="app-wrap"><header class="ant-layout-header"><div class="ant-row ant-row-start" style="padding:30px"><a style="flex:300px" href="/"><img src="/assets/img/sitecore-logo.svg" height="53px" alt="Sitecore JSS" class="logo"/></a><ul flex="auto" style="border-bottom:none" class="ant-menu ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>路路路</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/features">Features</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>路路路</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/docs">Documentation</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>路路路</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child ant-menu-item-selected" role="menuitem"><a class="nav-link" href="/guides">Guides</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>路路路</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.sitecore.com/getting-started/developer-trial">Trial</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>路路路</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/community">Community</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>路路路</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item get-started-button ant-menu-item-only-child" role="menuitem"><a class="btn btn-secondary btn-sm float-left text-white" href="/docs/getting-started/quick-start">Get Started</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>路路路</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></header><div class="main-wrapper"><section class="ant-layout border-bottom"><section class="jumbo-container jumbo-container-short bg-light"><div class="default"><div class="circleContainer"><div class="circleContainer-outer-top"><div class="circleContainer-inner"><div class="circleContainer-inner-primary"><div class="circ circ_right circle-fg-right-lg bg-success" id="defaultimage"><img src="/assets/img/transparent-1x1.png"/></div></div><div class="circleContainer-inner-secondary"><div class="circ circ_right circle-fg-right-lg-sub bg-primary"></div></div></div></div><div class="circleContainer-outer-bottom"><div class="circleContainer-inner"><div class="circleContainer-inner-primary"><div class="circle circle-fg-left-md bg-success"></div></div></div></div></div><div class="shapes-wrapper"><div class="outer-shape container"><div class="inner-shape row"><div class="content-wrapper col-12 col-md-9 min-height"><div class="content-wrapper-inner"><h1 class="title mb-3">Guides, Patterns, &amp; Recommended Practices</h1><p class="copy mb-0 p-0">A collection of learnings and recommendations from our developers and community, based on learnings from real-world projects.</p></div></div></div></div></div></div></section></section><div class="ant-row ant-row-space-between" style="margin-left:-20px;margin-right:-20px;flex-wrap:nowrap;margin:30px"><div style="padding-left:20px;padding-right:20px;flex:0 0 300px" class="ant-col"><aside><div class="side-nav"><ul class="ant-menu ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Thinking in JSS">Thinking in JSS<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-selected" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Code Patterns">Code Patterns<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Multisite Scenarios">Multisite Scenarios<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:24px"><a href="/guides/performance">Performance</a></li><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Debugging">Debugging<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="GraphQL">GraphQL<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title=" Work in Progress"> Work in Progress<i class="ant-menu-submenu-arrow"></i></div><div></div></li></ul><div class="navbar-nav bd-navbar-nav flex-column"></div></div></aside></div><div style="padding-left:20px;padding-right:20px;flex:auto" class="ant-col"><main><h1>SSR Recommended Practices</h1><section class="toc-container"><div class="title">In this guide</div><div match="[object Object]" location="[object Object]" history="[object Object]"><div class="toc">
<ul>
<li><a href="#image-resizing">Image Resizing</a><ul>
<li><a href="#resizing-images-in-graphql-queries">Resizing Images in GraphQL Queries</a></li>
<li><a href="#debugging-media-resizing">Debugging Media Resizing</a></li>
</ul>
</li>
<li><a href="#responsive-images">Responsive Images</a></li>
<li><a href="#using-a-cdn">Using a CDN</a></li>
<li><a href="#image-optimization">Image Optimization</a></li>
</ul>
</div>

</div></section><div class="article markdown-section" match="[object Object]" location="[object Object]" history="[object Object]"><h2 id="image-resizing">Image Resizing</h2>
<p>To enable image resizing in JSS, the size parameters must be whitelisted in Sitecore config. The sample apps show an example of how to achieve this:</p>
<ol>
<li><p>Customize the <code>allowMediaParams</code> portion of the Sitecore config.</p>
<pre><code class="xml language-xml">&lt;configuration xmlns:patch="http://www.sitecore.net/xmlconfig/"&gt;
  &lt;sitecore&gt;
    &lt;javaScriptServices&gt;
      &lt;!--
        You can use configuration patch(es) to add groups of
        media parameters that should&amp;nbsp;be allowed without a
        request protection hash in the URL. Parameter order
        is not important.
      --&gt;
      &lt;allowedMediaParams&gt;
        &lt;example&gt;mw=100,mh=50&lt;/example&gt;
        &lt;example2&gt;mw=100&lt;/example2&gt;
        &lt;example3&gt;mw=101,mh=51&lt;/example3&gt;
      &lt;/allowedMediaParams&gt;
    &lt;/javaScriptServices&gt;
  &lt;/sitecore&gt;
&lt;/configuration&gt;
</code></pre>
<p>Reference: (<a href="https://github.com/Sitecore/jss/blob/dev/samples/react/sitecore/config/JssReactWeb.config#L58"><code>JssReactWeb.config</code></a>)</p></li>
<li><p>Use JSS's <code>&lt;Image&gt;</code> component, passing matching values from step 1 to the <code>imageParams</code> prop.</p>
<pre><code class="javascript language-javascript">&lt;Image
  field={props.fields.sample2}
  editable={false}
  imageParams={{ mw: 100, mh: 50 }}
  height="50"
  width="94"
  data-sample="other-attributes-pass-through"
/&gt;
</code></pre>
<p>Reference: (<a href="https://github.com/Sitecore/jss/blob/dev/samples/react/src/components/Styleguide-FieldUsage-Image/index.js#L14"><code>Styleguide-FieldUsage-Image/index.js</code></a>)</p></li>
</ol>
<h3 id="resizing-images-in-graphql-queries">Resizing Images in GraphQL Queries</h3>
<p>Sample Query:</p>
<pre><code class="graphql language-graphql">query MyDemoQuery( $contextItem: String!) 
{
  contextItem: item(path: $contextItem) {
    ...on Jsspage {
      image {
        value
        img: editable(fieldRendererParameters: "mw=100")
        img2: editable(fieldRendererParameters: "w=150")
        img3: editable(fieldRendererParameters: "w=100&amp;h=100&amp;bc=AA4422")
        img4: editable(fieldRendererParameters: "w=2000&amp;as=true")
        img5: editable(fieldRendererParameters: "mw=250&amp;mh=250")
        rendered(fieldRendererParameters: "mw=100")
      }
    }
  }
}
</code></pre>
<p>Reference: <a href="http://www.stockpick.nl/english/scaling-sitecore-jss-images/">Scaling Sitecore JSS images by Jan BlueMink</a>.</p>
<h3 id="debugging-media-resizing">Debugging Media Resizing</h3>
<ol>
<li><p>Verify that JSS image whitelisting configuration exists. This is particularly important for JSS-SXA sites, where config deployments are abstracted away.</p></li>
<li><p>Make sure that <code>/media</code> urls are being changed to <code>/jssmedia</code>.<br />
(see <code>packages/sitecore-jss/src/mediaApi.ts</code>)</p></li>
<li><p>Make sure that <code>web.config</code> has the <code>sitecorejss_media.ashx</code> media handler defined.</p>
<pre><code class="xml language-xml">&lt;add name="Sitecore.JavaScriptServices.Media.MediaRequestHandler" verb="*" path="sitecorejss_media.ashx" type="Sitecore.JavaScriptServices.Media.MediaRequestHandler, Sitecore.JavaScriptServices.Media" /&gt;
</code></pre></li>
<li><p>Check the whitelist configuration for spaces.</p>
<p>Incorrect:</p>
<pre><code class="xml language-xml">&lt;allowedMediaParams&gt;
  &lt;!-- space between width and height is not ok --&gt;
  &lt;example&gt;mw=100, mh=50&lt;/example&gt;
&lt;/allowedMediaParams&gt;
</code></pre>
<p>Correct:</p>
<pre><code class="xml language-xml">&lt;allowedMediaParams&gt;
  &lt;!-- No spaces  --&gt;
  &lt;example&gt;mw=100,mh=50&lt;/example&gt;
&lt;/allowedMediaParams&gt;
</code></pre></li>
</ol>
<hr />
<h2 id="responsive-images">Responsive Images</h2>
<p>After enabling image resizing per the guide above, adaptive <code>srcset</code>s can be utilized to render responsive images with server-side resizing.<br />
The <code>srcSet</code> prop can use Sitecore image resizing parameters (i.e. w, h, mw, mh).<br />
Sample create a srcSet using two sizes (server resizing), 300 and 100px max widths, respecting aspect ratio.</p>
<blockquote>
  <p><em>Important</em>: <code>srcSet</code> params must be whitelisted within <code>allowedMediaParams</code> for adaptive resizing to occur.</p>
</blockquote>
<pre><code class="html language-html">&lt;Image
  field={props.fields.sample2}
  srcSet={[{&amp;nbsp;mw:&amp;nbsp;300&amp;nbsp;},&amp;nbsp;{&amp;nbsp;mw:&amp;nbsp;100&amp;nbsp;}]}
  sizes="(min-width:&amp;nbsp;960px)&amp;nbsp;300px,&amp;nbsp;100px"
  className="img-fluid"
/&gt;
</code></pre>
<hr />
<h2 id="using-a-cdn">Using a CDN</h2>
<p>The ability to use a CDN for Media Library Assets is part of core Sitecore functionality, so setting this up is not JSS-specific. Refer to the official Sitecore CDN docs for setup instructions. The resulting media urls will automatically work in JSS apps as long as you are rending images using JSS's <Image> component or fetching image data using JSS's mediaApi</p>
<ul>
<li><p><a href="https://doc.sitecore.com/developers/100/sitecore-experience-manager/en/manually-configure-the-sitecore-media-library-to-use-a-cdn.html">Manually configure the Sitecore Media Library to use a CDN</a> - the .</p></li>
<li><p><a href="https://doc.sitecore.com/developers/100/sitecore-experience-manager/en/sitecore-media-library-cdn-related-configuration-reference.html">Sitecore Media Library CDN-related configuration reference</a></p></li>
</ul>
<hr />
<h2 id="image-optimization">Image Optimization</h2>
<p>If using Media Library for images (rather than Content Hub), 3rd party tools can help with optimization.</p>
<p>Examples:</p>
<p><a href="https://github.com/kamsar/Dianoga">Sitecore Dianoga</a> -  an image Optimization module by <a href="https://twitter.com/kamsar">Kam Figy</a>. Dianoga is compatible with JSS and can be used to optimize images on the server side.</p>
<p><a href="https://www.imgix.com/">imgIX</a> - an image processing platform with a simple API. imgix transforms, optimizes, and intelligently caches your image library for fast websites and apps using simple and robust URL parameters.</p>
</div><hr/><div>Found a problem? Have something to add?<a href="https://github.com/Sitecore/jss/edit/guides/docs/data/routes/guides/code-patterns/ssr/en.md">Edit this on GitHub</a></div></main></div></div></div><footer class="ant-layout-footer"><div class="ant-row ant-row-center" style="margin-left:-16px;margin-right:-16px"><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/features">Features</a><nav class="nav flex-column"><a class="nav-link small text-white" href="/features/why-jss">Why JSS?</a><a class="nav-link small text-white" href="/features/why-sitecore">Why Sitecore?</a></nav></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/docs">Documentation</a><nav class="nav flex-column"><a class="nav-link small text-white" href="/docs/getting-started/quick-start">Getting Started</a><a class="nav-link small text-white" href="/docs/fundamentals/architecture">Fundamentals</a><a class="nav-link small text-white" href="/docs/client-frameworks/react/react-overview">Client Frameworks</a><a class="nav-link small text-white" href="/docs/techniques/mvc-integration/javascript-rendering">Techniques</a><a class="nav-link small text-white" href="/release-notes">Release Notes</a><a class="nav-link small text-white" href="/help">FAQs</a></nav></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a href="https://www.sitecore.com/getting-started/developer-trial" target="_blank" rel="noopener noreferrer" class="nav-link text-uppercase small text-white font-weight-bold">Start Trial</a></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/community">Community</a><nav class="nav flex-column"><a href="#" class="nav-link small text-white">Sitecore Community</a><a href="slack://channel?team=T09SHRBNU&amp;id=C7JT0NRQW" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" focusable="false"><title>Slack</title><path fill="currentColor" d="M210.787 234.832l68.31-22.883 22.1 65.977-68.309 22.882z"></path><path d="M490.54 185.6C437.7 9.59 361.6-31.34 185.6 21.46S-31.3 150.4 21.46 326.4 150.4 543.3 326.4 490.54 543.34 361.6 490.54 185.6zM401.7 299.8l-33.15 11.05 11.46 34.38c4.5 13.92-2.87 29.06-16.78 33.56-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18l-11.46-34.38-68.36 22.92 11.46 34.38c4.5 13.92-2.87 29.06-16.78 33.56-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18l-11.46-34.43-33.15 11.05c-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18c-4.5-13.92 2.87-29.06 16.78-33.56l33.12-11.03-22.1-65.9-33.15 11.05c-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18c-4.48-13.93 2.89-29.07 16.81-33.58l33.15-11.05-11.46-34.38c-4.5-13.92 2.87-29.06 16.78-33.56s29.06 2.87 33.56 16.78l11.46 34.38 68.36-22.92-11.46-34.38c-4.5-13.92 2.87-29.06 16.78-33.56s29.06 2.87 33.56 16.78l11.47 34.42 33.15-11.05c13.92-4.5 29.06 2.87 33.56 16.78s-2.87 29.06-16.78 33.56L329.7 194.6l22.1 65.9 33.15-11.05c13.92-4.5 29.06 2.87 33.56 16.78s-2.88 29.07-16.81 33.57z" fill="currentColor"></path></svg>JSS Slack</a><a href="https://sitecore.stackexchange.com/tags/jss" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120"><title>Sitecore StackExchange</title><path fill="currentColor" d="M22.4 57.5h74.8v15.4H22.4z"></path><path fill="currentColor" d="M22.4 37.6h74.8V53H22.4z"></path><path fill="currentColor" d="M85.5 17H34.4c-6.6 0-12 5.5-12 12.3v4h74.8v-4C97.2 22.5 92 17 85.5 17z"></path><path fill="currentColor" d="M22.4 77.3v4c0 6.8 5.4 12.3 12 12.3h32v16.3l15.8-16.3h3.5c6.6 0 12-5.5 12-12.3v-4H22.4z"></path></svg>Stack Exchange</a><a href="https://github.com/sitecore/jss" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd"></path></svg>Github</a></nav></div></div><div class="ant-row ant-row-center" style="margin:30px"><div class="ant-col footer-copyright small">漏 Copyright <!-- -->2020<!-- -->, Sitecore. All Rights Reserved.</div><div class="ant-col footer-copyright small"><a href="https://www.sitecore.com/trust" class="pl-2 pr-2" target="_blank" rel="noopener noreferrer">Legal</a><a href="https://www.sitecore.com/trust/privacy-policy" class="pl-2" target="_blank" rel="noopener noreferrer">Privacy</a></div></div></footer></section></div><script>window.__data={"sitecore":{"context":{"pageEditing":false,"site":{"name":"JssDisconnectedLayoutService"},"pageState":"normal","language":"en"},"route":{"databaseName":"available-in-connected-mode","deviceId":"available-in-connected-mode","itemId":"available-in-connected-mode","itemLanguage":"en","itemVersion":1,"layoutId":"available-in-connected-mode","templateId":"available-in-connected-mode","templateName":"Docs Route","name":"media-handling","fields":{"title":{"value":"Media Handling Guide"},"editLink":{"value":{"text":"Edit this on GitHub","href":"https://github.com/Sitecore/jss/edit/guides/docs/data/routes/guides/code-patterns/media-handling/en.md"}}},"placeholders":{"jssdocs-header":[{"uid":"{DC7EF28B-A5D9-5B14-8E97-BB5B236711FF}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"start","padding":"30px"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{2266AD34-29E6-5C9E-AA2C-F42EC21BDA16}","componentName":"Logo","dataSource":"available-in-connected-mode","params":{"flex":"300px"},"fields":{}},{"uid":"{9ABD8B71-2186-5DFA-A975-6BF720CDABDB}","componentName":"MainNav","dataSource":"available-in-connected-mode","params":{"flex":"auto"},"fields":{"selectedMenuItem":{"value":"guides"}}}]}}],"jssdocs-main":[{"uid":"{E6DDE5C0-B40B-5830-96B3-6E264BABFD16}","componentName":"ArticleContainer","dataSource":"available-in-connected-mode","params":{},"fields":{},"placeholders":{"jssdocs-jumbo":[{"uid":"{64B08BCE-12E4-51F7-81D0-D8B5104358BD}","componentName":"FeatureJumboShort","dataSource":"available-in-connected-mode","params":{},"fields":{"image":{"value":{"src":"/assets/img/transparent-1x1.png"}},"imageclass":{"value":"defaultimage"},"csscolorclass":{"value":"default"},"title":{"value":"Guides, Patterns, & Recommended Practices"},"text":{"value":"A collection of learnings and recommendations from our developers and community, based on learnings from real-world projects."}}}],"jssdocs-aside":[{"uid":"{BD8F384A-D275-5649-AFE4-7F5403471C54}","componentName":"SideNav","dataSource":"available-in-connected-mode","params":{},"fields":{"navType":{"value":"guides"},"useSearch":{"value":"false"}}}],"jssdocs-content":[{"uid":"{0C6E5FA3-6084-553E-8B9E-952DB2D16169}","componentName":"Guide","dataSource":"available-in-connected-mode","params":{},"fields":{"text":{"value":"<h2 id=\"image-resizing\">Image Resizing</h2>\n<p>To enable image resizing in JSS, the size parameters must be whitelisted in Sitecore config. The sample apps show an example of how to achieve this:</p>\n<ol>\n<li><p>Customize the <code>allowMediaParams</code> portion of the Sitecore config.</p>\n<pre><code class=\"xml language-xml\">&lt;configuration xmlns:patch=\"http://www.sitecore.net/xmlconfig/\"&gt;\n  &lt;sitecore&gt;\n    &lt;javaScriptServices&gt;\n      &lt;!--\n        You can use configuration patch(es) to add groups of\n        media parameters that should&amp;nbsp;be allowed without a\n        request protection hash in the URL. Parameter order\n        is not important.\n      --&gt;\n      &lt;allowedMediaParams&gt;\n        &lt;example&gt;mw=100,mh=50&lt;/example&gt;\n        &lt;example2&gt;mw=100&lt;/example2&gt;\n        &lt;example3&gt;mw=101,mh=51&lt;/example3&gt;\n      &lt;/allowedMediaParams&gt;\n    &lt;/javaScriptServices&gt;\n  &lt;/sitecore&gt;\n&lt;/configuration&gt;\n</code></pre>\n<p>Reference: (<a href=\"https://github.com/Sitecore/jss/blob/dev/samples/react/sitecore/config/JssReactWeb.config#L58\"><code>JssReactWeb.config</code></a>)</p></li>\n<li><p>Use JSS's <code>&lt;Image&gt;</code> component, passing matching values from step 1 to the <code>imageParams</code> prop.</p>\n<pre><code class=\"javascript language-javascript\">&lt;Image\n  field={props.fields.sample2}\n  editable={false}\n  imageParams={{ mw: 100, mh: 50 }}\n  height=\"50\"\n  width=\"94\"\n  data-sample=\"other-attributes-pass-through\"\n/&gt;\n</code></pre>\n<p>Reference: (<a href=\"https://github.com/Sitecore/jss/blob/dev/samples/react/src/components/Styleguide-FieldUsage-Image/index.js#L14\"><code>Styleguide-FieldUsage-Image/index.js</code></a>)</p></li>\n</ol>\n<h3 id=\"resizing-images-in-graphql-queries\">Resizing Images in GraphQL Queries</h3>\n<p>Sample Query:</p>\n<pre><code class=\"graphql language-graphql\">query MyDemoQuery( $contextItem: String!) \n{\n  contextItem: item(path: $contextItem) {\n    ...on Jsspage {\n      image {\n        value\n        img: editable(fieldRendererParameters: \"mw=100\")\n        img2: editable(fieldRendererParameters: \"w=150\")\n        img3: editable(fieldRendererParameters: \"w=100&amp;h=100&amp;bc=AA4422\")\n        img4: editable(fieldRendererParameters: \"w=2000&amp;as=true\")\n        img5: editable(fieldRendererParameters: \"mw=250&amp;mh=250\")\n        rendered(fieldRendererParameters: \"mw=100\")\n      }\n    }\n  }\n}\n</code></pre>\n<p>Reference: <a href=\"http://www.stockpick.nl/english/scaling-sitecore-jss-images/\">Scaling Sitecore JSS images by Jan BlueMink</a>.</p>\n<h3 id=\"debugging-media-resizing\">Debugging Media Resizing</h3>\n<ol>\n<li><p>Verify that JSS image whitelisting configuration exists. This is particularly important for JSS-SXA sites, where config deployments are abstracted away.</p></li>\n<li><p>Make sure that <code>/media</code> urls are being changed to <code>/jssmedia</code>.<br />\n(see <code>packages/sitecore-jss/src/mediaApi.ts</code>)</p></li>\n<li><p>Make sure that <code>web.config</code> has the <code>sitecorejss_media.ashx</code> media handler defined.</p>\n<pre><code class=\"xml language-xml\">&lt;add name=\"Sitecore.JavaScriptServices.Media.MediaRequestHandler\" verb=\"*\" path=\"sitecorejss_media.ashx\" type=\"Sitecore.JavaScriptServices.Media.MediaRequestHandler, Sitecore.JavaScriptServices.Media\" /&gt;\n</code></pre></li>\n<li><p>Check the whitelist configuration for spaces.</p>\n<p>Incorrect:</p>\n<pre><code class=\"xml language-xml\">&lt;allowedMediaParams&gt;\n  &lt;!-- space between width and height is not ok --&gt;\n  &lt;example&gt;mw=100, mh=50&lt;/example&gt;\n&lt;/allowedMediaParams&gt;\n</code></pre>\n<p>Correct:</p>\n<pre><code class=\"xml language-xml\">&lt;allowedMediaParams&gt;\n  &lt;!-- No spaces  --&gt;\n  &lt;example&gt;mw=100,mh=50&lt;/example&gt;\n&lt;/allowedMediaParams&gt;\n</code></pre></li>\n</ol>\n<hr />\n<h2 id=\"responsive-images\">Responsive Images</h2>\n<p>After enabling image resizing per the guide above, adaptive <code>srcset</code>s can be utilized to render responsive images with server-side resizing.<br />\nThe <code>srcSet</code> prop can use Sitecore image resizing parameters (i.e. w, h, mw, mh).<br />\nSample create a srcSet using two sizes (server resizing), 300 and 100px max widths, respecting aspect ratio.</p>\n<blockquote>\n  <p><em>Important</em>: <code>srcSet</code> params must be whitelisted within <code>allowedMediaParams</code> for adaptive resizing to occur.</p>\n</blockquote>\n<pre><code class=\"html language-html\">&lt;Image\n  field={props.fields.sample2}\n  srcSet={[{&amp;nbsp;mw:&amp;nbsp;300&amp;nbsp;},&amp;nbsp;{&amp;nbsp;mw:&amp;nbsp;100&amp;nbsp;}]}\n  sizes=\"(min-width:&amp;nbsp;960px)&amp;nbsp;300px,&amp;nbsp;100px\"\n  className=\"img-fluid\"\n/&gt;\n</code></pre>\n<hr />\n<h2 id=\"using-a-cdn\">Using a CDN</h2>\n<p>The ability to use a CDN for Media Library Assets is part of core Sitecore functionality, so setting this up is not JSS-specific. Refer to the official Sitecore CDN docs for setup instructions. The resulting media urls will automatically work in JSS apps as long as you are rending images using JSS's <Image> component or fetching image data using JSS's mediaApi</p>\n<ul>\n<li><p><a href=\"https://doc.sitecore.com/developers/100/sitecore-experience-manager/en/manually-configure-the-sitecore-media-library-to-use-a-cdn.html\">Manually configure the Sitecore Media Library to use a CDN</a> - the .</p></li>\n<li><p><a href=\"https://doc.sitecore.com/developers/100/sitecore-experience-manager/en/sitecore-media-library-cdn-related-configuration-reference.html\">Sitecore Media Library CDN-related configuration reference</a></p></li>\n</ul>\n<hr />\n<h2 id=\"image-optimization\">Image Optimization</h2>\n<p>If using Media Library for images (rather than Content Hub), 3rd party tools can help with optimization.</p>\n<p>Examples:</p>\n<p><a href=\"https://github.com/kamsar/Dianoga\">Sitecore Dianoga</a> -  an image Optimization module by <a href=\"https://twitter.com/kamsar\">Kam Figy</a>. Dianoga is compatible with JSS and can be used to optimize images on the server side.</p>\n<p><a href=\"https://www.imgix.com/\">imgIX</a> - an image processing platform with a simple API. imgix transforms, optimizes, and intelligently caches your image library for fast websites and apps using simple and robust URL parameters.</p>\n"},"toc":{"value":"<div class=\"toc\">\n<ul>\n<li><a href=\"#image-resizing\">Image Resizing</a><ul>\n<li><a href=\"#resizing-images-in-graphql-queries\">Resizing Images in GraphQL Queries</a></li>\n<li><a href=\"#debugging-media-resizing\">Debugging Media Resizing</a></li>\n</ul>\n</li>\n<li><a href=\"#responsive-images\">Responsive Images</a></li>\n<li><a href=\"#using-a-cdn\">Using a CDN</a></li>\n<li><a href=\"#image-optimization\">Image Optimization</a></li>\n</ul>\n</div>\n\n"}}}]}}],"jssdocs-footer":[{"uid":"{86FD7832-4170-5737-BD18-1F76A36D872C}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"center","compactGutter":"24","fullSizeGutter":"32"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{89D1241F-28EC-59A8-9983-B4513A64A39F}","componentName":"FooterNav","dataSource":"available-in-connected-mode","params":{},"fields":{}}]}},{"uid":"{940E2CD2-4899-58F4-8074-D2305F554C2A}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"center","margin":"30px"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{6E464584-F2FD-57BD-961D-59CEE8D89D8B}","componentName":"Disclaimers","dataSource":"available-in-connected-mode","params":{},"fields":{}}]}}]}}},"viewBag":{}};</script><script src="/assets/js/highlight.pack.js"></script><script src="/dist/vendor-client.bundle.js"></script><script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script src="/dist/client.bundle.js"></script></body></html>